{"ast":null,"code":"import React from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import api from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Checkout(_ref){let{cart,user,setCart}=_ref;const navigate=useNavigate();const totalPrice=cart.reduce((total,pizza)=>{const price=pizza.price||0;return total+price*pizza.quantity;},0);const handlePlaceOrder=async()=>{if(!user){toast.error('You must be logged in to place an order.');navigate('/login');return;}if(cart.length===0){toast.error('Your cart is empty.');return;}const orderDetails={userId:user.user.id,pizzas:cart.map(item=>({pizzaId:!item.isCustom?item._id:null,name:item.name,price:item.price,quantity:item.quantity,size:!item.isCustom?item.size:undefined,// Add the size\nbase:item.isCustom?item.base:undefined,sauce:item.isCustom?item.sauce:undefined,isCustom:!!item.isCustom})),totalAmount:totalPrice};try{const config={headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${user.token}`}};await api.post(\"/orders\",orderDetails,config);toast.success(\"Order placed successfully!\");setCart([]);// Clear the cart\nnavigate(\"/my-orders\");// Redirect to an order history page\n}catch(error){toast.error('Failed to place order. Please try again.');console.error('Order placement error:',error);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',maxWidth:'600px',margin:'auto'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Checkout\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"}),cart.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',borderBottom:'1px solid #eee',padding:'10px 0'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[item.name,\" (x\",item.quantity,\")\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",((item.price||0)*item.quantity).toFixed(2)]})]},item.cartId||index)),/*#__PURE__*/_jsxs(\"h3\",{style:{textAlign:'right',marginTop:'1rem'},children:[\"Total: \\u20B9\",totalPrice.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePlaceOrder,style:{marginTop:'1rem',width:'100%',padding:'15px',backgroundColor:'#007bff',color:'white',border:'none',borderRadius:'5px',cursor:'pointer',fontSize:'16px'},children:\"Confirm and Place Order\"})]});}","map":{"version":3,"names":["React","useNavigate","toast","api","jsx","_jsx","jsxs","_jsxs","Checkout","_ref","cart","user","setCart","navigate","totalPrice","reduce","total","pizza","price","quantity","handlePlaceOrder","error","length","orderDetails","userId","id","pizzas","map","item","pizzaId","isCustom","_id","name","size","undefined","base","sauce","totalAmount","config","headers","Authorization","token","post","success","console","style","padding","maxWidth","margin","children","index","display","justifyContent","borderBottom","toFixed","cartId","textAlign","marginTop","onClick","width","backgroundColor","color","border","borderRadius","cursor","fontSize"],"sources":["C:/Users/LAPZONE/pizza-delivery-app/frontend/src/pages/Checkout.js"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport api from '../api';\r\n\r\nexport default function Checkout({ cart, user, setCart }) {\r\n  const navigate = useNavigate();\r\n\r\n  const totalPrice = cart.reduce((total, pizza) => {\r\n    const price = pizza.price || 0;\r\n    return total + (price * pizza.quantity);\r\n  }, 0);\r\n\r\n  const handlePlaceOrder = async () => {\r\n    if (!user) {\r\n      toast.error('You must be logged in to place an order.');\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    if (cart.length === 0) {\r\n      toast.error('Your cart is empty.');\r\n      return;\r\n    }\r\n\r\n    const orderDetails = {\r\n      userId: user.user.id,\r\n      pizzas: cart.map((item) => ({\r\n        pizzaId: !item.isCustom ? item._id : null,\r\n        name: item.name,\r\n        price: item.price,\r\n        quantity: item.quantity,\r\n        size: !item.isCustom ? item.size : undefined, // Add the size\r\n        base: item.isCustom ? item.base : undefined, \r\n        sauce: item.isCustom ? item.sauce : undefined,\r\n        isCustom: !!item.isCustom,\r\n      })),\r\n      totalAmount: totalPrice,\r\n    };\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      await api.post(\"/orders\", orderDetails, config);\r\n\r\n      toast.success(\"Order placed successfully!\");\r\n      setCart([]); // Clear the cart\r\n      navigate(\"/my-orders\"); // Redirect to an order history page\r\n    } catch (error) {\r\n      toast.error('Failed to place order. Please try again.');\r\n      console.error('Order placement error:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '20px', maxWidth: '600px', margin: 'auto' }}>\r\n      <h1>Checkout</h1>\r\n      <h2>Order Summary</h2>\r\n      {cart.map((item, index) => (\r\n        <div key={item.cartId || index} style={{ display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid #eee', padding: '10px 0' }}>\r\n          <span>{item.name} (x{item.quantity})</span>\r\n          <span>₹{((item.price || 0) * item.quantity).toFixed(2)}</span>\r\n        </div>\r\n      ))}\r\n      <h3 style={{ textAlign: 'right', marginTop: '1rem' }}>\r\n        Total: ₹{totalPrice.toFixed(2)}\r\n      </h3>\r\n      <button\r\n        onClick={handlePlaceOrder}\r\n        style={{ marginTop: '1rem', width: '100%', padding: '15px', backgroundColor: '#007bff', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer', fontSize: '16px' }}\r\n      >\r\n        Confirm and Place Order\r\n      </button>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}